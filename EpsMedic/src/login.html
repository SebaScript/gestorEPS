<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link rel="icon" type="image/svg+xml" href="/medicLogo.svg" />
    <link rel="stylesheet" href="tailwind.css" />
    <script src="https://cdn.auth0.com/js/auth0/9.19/auth0.min.js"></script>
  </head>
  <body>
    <div id="contenedor" class="flex flex-col items-center justify-center h-screen bg-gray-100">
      <div id="divPortada" class="mb-10 text-center">
        <h1 id="title" class="text-2xl font-bold">Supra EPS</h1>
      </div>

      <div id="divLogin" class="bg-white p-10 rounded-lg shadow-lg text-center">
        <div id="divButton" class="mt-5">
          <button type="button" id="login-button">
            Login
          </button>
        </div>
      </div>
    </div>

    <script>
      // Configura Auth0
      var auth0 = new auth0.WebAuth({
        domain: "dev-hwvaiwpn86l5fpxt.us.auth0.com",
        clientID: "0N1atYMnyYFsPRlNDcWvIbM0I6Nh7GME",
        responseType: "token id_token",
        scope: "openid profile email",
        redirectUri: window.location.origin + "/index.html", // Redirige a index.html después del login
      });

      // Verifica si el usuario está logueado
      function isAuthenticated() {
        return localStorage.getItem('id_token') !== null;
      }

      // Maneja el estado de autenticación
      function handleAuthentication() {
        auth0.parseHash(function(err, authResult) {
          if (authResult && authResult.idToken) {
            window.location.hash = '';
            localStorage.setItem('id_token', authResult.idToken);
            window.location.href = 'index.html'; // Redirige a index.html después de guardar el token
          } else if (err) {
            console.log(err);
          }
        });
      }

      // Verifica el estado de autenticación al cargar la página
      window.onload = function() {
        handleAuthentication();
      };

      document.getElementById("login-button").addEventListener("click", function () {
        auth0.authorize();
      });
    </script>
  </body>
</html>